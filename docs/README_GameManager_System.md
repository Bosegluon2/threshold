# GameManager æ¸¸æˆç®¡ç†ç³»ç»Ÿ

## ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ¸¸æˆç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨å•ä¾‹æ¨¡å¼è®¾è®¡ï¼Œæ€»ç®¡ä¸€å±€æ¸¸æˆä¸­çš„æ‰€æœ‰å†…å®¹ã€‚ç³»ç»Ÿè®¾è®¡ä¸º10å¤©æ¸¸æˆæ—¶é•¿ï¼Œæ¯å¤©åˆ†ä¸º4ä¸ªæ—¶æ®µï¼ˆæ—©ä¸Šã€ä¸­åˆã€æ™šä¸Šã€åŠå¤œï¼‰ï¼Œæ€»å…±40ä¸ªå›åˆã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ• æ—¶é—´ç³»ç»Ÿ
- **å›åˆåˆ¶**: æ¯å›åˆå¯é…ç½®æŒç»­æ—¶é—´ï¼ˆé»˜è®¤5ç§’ï¼‰
- **æ—¶æ®µåˆ’åˆ†**: æ—©ä¸Šã€ä¸­åˆã€æ™šä¸Šã€åŠå¤œï¼ˆç‰¹æ®Šå›åˆï¼‰
- **è‡ªåŠ¨æ¨è¿›**: æ—¶é—´è‡ªåŠ¨æµé€ï¼Œæ”¯æŒæš‚åœ/æ¢å¤
- **è¿›åº¦è·Ÿè¸ª**: å®æ—¶æ˜¾ç¤ºæ¸¸æˆè¿›åº¦å’Œå‰©ä½™æ—¶é—´

### ğŸ² äº‹ä»¶ç³»ç»Ÿ
- **æ—¶æ®µäº‹ä»¶**: ä¸åŒæ—¶æ®µè§¦å‘ä¸åŒç±»å‹çš„äº‹ä»¶
- **éšæœºäº‹ä»¶**: åŸºäºæ¦‚ç‡çš„éšæœºäº‹ä»¶ç³»ç»Ÿ
- **äº‹ä»¶ä¼˜å…ˆçº§**: ä½ã€æ™®é€šã€é«˜ã€å…³é”®å››ä¸ªä¼˜å…ˆçº§
- **äº‹ä»¶ç®¡ç†**: æ”¯æŒäº‹ä»¶è§¦å‘ã€å®Œæˆã€å¤±è´¥ç­‰çŠ¶æ€

### ğŸ“¦ èµ„æºç³»ç»Ÿ
- **å¤šç§èµ„æº**: é£Ÿç‰©ã€æ°´ã€è¯å“ã€å¼¹è¯ã€ç‡ƒæ–™ã€ææ–™ã€é‡‘é’±
- **åŠ¨æ€å˜åŒ–**: æ”¯æŒæ—¥å¸¸æ¶ˆè€—ã€ç”Ÿäº§ã€è¡°å‡
- **çŠ¶æ€ç›‘æ§**: å®æ—¶ç›‘æ§èµ„æºçŠ¶æ€ï¼Œé¢„è­¦æœºåˆ¶
- **ä¸Šé™ç®¡ç†**: å¯é…ç½®çš„èµ„æºä¸Šé™å’Œæº¢å‡ºå¤„ç†

### ğŸŒ ä¸–ç•Œç³»ç»Ÿ
- **åŠ¨æ€å¤©æ°”**: 6ç§å¤©æ°”ç±»å‹ï¼Œå½±å“æ¸¸æˆä½“éªŒ
- **å±é™©ç­‰çº§**: åŸºäºæ—¶é—´ã€å¤©æ°”ã€è¿›åº¦çš„åŠ¨æ€å±é™©ç³»ç»Ÿ
- **ä¸–ç•ŒçŠ¶æ€**: å®‰å…¨ã€æ­£å¸¸ã€å±é™©ã€å±æ€¥ã€æ··ä¹±äº”ç§çŠ¶æ€
- **ç¯å¢ƒå½±å“**: å¤©æ°”å¯¹è§†é‡ã€ç§»åŠ¨ã€æ”¶é›†çš„å½±å“

### ğŸ’¾ å­˜æ¡£ç³»ç»Ÿ
- **å¤šå­˜æ¡£æ§½**: æ”¯æŒå¤šä¸ªå­˜æ¡£ä½ç½®
- **è‡ªåŠ¨ä¿å­˜**: å¯é…ç½®çš„è‡ªåŠ¨ä¿å­˜åŠŸèƒ½
- **æ•°æ®å®Œæ•´æ€§**: å®Œæ•´çš„æ¸¸æˆçŠ¶æ€ä¿å­˜

### ğŸ® æ¸¸æˆæ§åˆ¶
- **çŠ¶æ€ç®¡ç†**: æœªå¼€å§‹ã€æ¸¸æˆä¸­ã€æš‚åœã€ç»“æŸç­‰çŠ¶æ€
- **ä¿¡å·ç³»ç»Ÿ**: å®Œæ•´çš„äº‹ä»¶ä¿¡å·ç³»ç»Ÿ
- **è°ƒè¯•æ”¯æŒ**: ä¸°å¯Œçš„è°ƒè¯•ä¿¡æ¯å’Œç»Ÿè®¡åŠŸèƒ½

## ç³»ç»Ÿæ¶æ„

```
GameManager (æ€»ç®¡ç†å™¨ - å•ä¾‹)
â”œâ”€â”€ TimeManager (æ—¶é—´ç®¡ç†)
â”œâ”€â”€ EventManager (äº‹ä»¶ç®¡ç†)
â”œâ”€â”€ ResourceManager (èµ„æºç®¡ç†)
â”œâ”€â”€ CharacterManager (è§’è‰²ç®¡ç†)
â”œâ”€â”€ WorldManager (ä¸–ç•Œç®¡ç†)
â”œâ”€â”€ SaveManager (å­˜æ¡£ç®¡ç†)
â””â”€â”€ UIManager (ç•Œé¢ç®¡ç†)
```

## ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬åˆå§‹åŒ–

```csharp
// GameManagerä¼šè‡ªåŠ¨åˆ›å»ºå¹¶ç®¡ç†æ‰€æœ‰å­ç®¡ç†å™¨
var gameManager = GameManager.Instance;

// å¼€å§‹æ–°æ¸¸æˆ
gameManager.StartNewGame();

// æš‚åœ/æ¢å¤æ¸¸æˆ
gameManager.PauseGame();
gameManager.ResumeGame();
```

### 2. æ—¶é—´æ§åˆ¶

```csharp
// è®¾ç½®å›åˆæŒç»­æ—¶é—´
gameManager.TimeManager.SetTurnDuration(3.0f);

// æ‰‹åŠ¨è¿›å…¥ä¸‹ä¸€å›åˆ
gameManager.TimeManager.NextTurn();

// è·å–æ—¶é—´ä¿¡æ¯
var currentTime = gameManager.TimeManager.GetCurrentTimeDescription();
var progress = gameManager.TimeManager.GetGameProgress();
```

### 3. èµ„æºç®¡ç†

```csharp
// æ·»åŠ èµ„æº
gameManager.ResourceManager.AddResource("food", 20, "æ”¶é›†è·å¾—");

// æ¶ˆè€—èµ„æº
gameManager.ResourceManager.ConsumeResource("water", 5, "æ—¥å¸¸æ¶ˆè€—");

// æ£€æŸ¥èµ„æºçŠ¶æ€
var foodResource = gameManager.ResourceManager.GetResource("food");
if (foodResource.IsSufficient(10))
{
    // æ‰§è¡Œéœ€è¦10ä¸ªé£Ÿç‰©çš„æ“ä½œ
}
```

### 4. äº‹ä»¶ç³»ç»Ÿ

```csharp
// åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶
var customEvent = new GameEvent("custom_event", "è‡ªå®šä¹‰äº‹ä»¶", "äº‹ä»¶æè¿°");

// è§¦å‘äº‹ä»¶
gameManager.EventManager.TriggerEvent(customEvent);

// å®Œæˆäº‹ä»¶
gameManager.EventManager.CompleteEvent("custom_event");
```

### 5. ä¸–ç•ŒçŠ¶æ€

```csharp
// è·å–ä¸–ç•ŒçŠ¶æ€
var worldState = gameManager.WorldManager.GetWorldStateDescription();
var weatherEffects = gameManager.WorldManager.GetWeatherEffects();

// æ£€æŸ¥å±é™©ç­‰çº§
var dangerLevel = gameManager.WorldManager.DangerLevel;
```

## ä¿¡å·ç³»ç»Ÿ

ç³»ç»Ÿä½¿ç”¨Godotçš„ä¿¡å·ç³»ç»Ÿè¿›è¡Œé€šä¿¡ï¼Œä¸»è¦ä¿¡å·åŒ…æ‹¬ï¼š

- `GameStarted`: æ¸¸æˆå¼€å§‹
- `GamePaused`: æ¸¸æˆæš‚åœ
- `GameResumed`: æ¸¸æˆæ¢å¤
- `GameOver`: æ¸¸æˆç»“æŸ
- `TurnChanged`: å›åˆå˜åŒ–
- `EventTriggered`: äº‹ä»¶è§¦å‘
- `ResourceChanged`: èµ„æºå˜åŒ–
- `WorldStateChanged`: ä¸–ç•ŒçŠ¶æ€å˜åŒ–

## é…ç½®é€‰é¡¹

### æ—¶é—´é…ç½®
- `TotalDays`: æ€»æ¸¸æˆå¤©æ•°ï¼ˆé»˜è®¤10å¤©ï¼‰
- `TurnsPerDay`: æ¯å¤©å›åˆæ•°ï¼ˆé»˜è®¤4å›åˆï¼‰
- `TurnDuration`: æ¯å›åˆæŒç»­æ—¶é—´ï¼ˆé»˜è®¤5ç§’ï¼‰

### äº‹ä»¶é…ç½®
- `RandomEventChance`: éšæœºäº‹ä»¶æ¦‚ç‡ï¼ˆé»˜è®¤30%ï¼‰
- `MaxActiveEvents`: æœ€å¤§æ´»è·ƒäº‹ä»¶æ•°ï¼ˆé»˜è®¤5ä¸ªï¼‰
- `EnableRandomEvents`: æ˜¯å¦å¯ç”¨éšæœºäº‹ä»¶ï¼ˆé»˜è®¤å¼€å¯ï¼‰

### èµ„æºé…ç½®
- `EnableResourceDecay`: æ˜¯å¦å¯ç”¨èµ„æºè¡°å‡ï¼ˆé»˜è®¤å¼€å¯ï¼‰
- `GlobalDecayMultiplier`: å…¨å±€è¡°å‡å€æ•°ï¼ˆé»˜è®¤1.0ï¼‰
- `CriticalThreshold`: èµ„æºç´§ç¼ºé˜ˆå€¼ï¼ˆé»˜è®¤20%ï¼‰

## æµ‹è¯•å’Œè°ƒè¯•

ç³»ç»ŸåŒ…å«å®Œæ•´çš„æµ‹è¯•è„šæœ¬ `GameManagerTest.cs`ï¼Œæä¾›ï¼š

- æ¸¸æˆæ§åˆ¶æŒ‰é’®ï¼ˆå¼€å§‹ã€æš‚åœã€æ¢å¤ã€ä¸‹ä¸€å›åˆï¼‰
- ä¿¡æ¯æ˜¾ç¤ºé¢æ¿
- å­˜æ¡£/è¯»æ¡£æµ‹è¯•
- å®æ—¶çŠ¶æ€ç›‘æ§

## æ‰©å±•å»ºè®®

### 1. è§’è‰²ç³»ç»Ÿ
- é›†æˆç°æœ‰çš„Characterå’ŒRelationç³»ç»Ÿ
- æ·»åŠ è§’è‰²çŠ¶æ€ç®¡ç†ï¼ˆå¥åº·ã€é¥¥é¥¿ã€ç–²åŠ³ç­‰ï¼‰
- å®ç°è§’è‰²é—´çš„äº’åŠ¨å’Œå…³ç³»å‘å±•

### 2. ä»»åŠ¡ç³»ç»Ÿ
- åŸºäºäº‹ä»¶ç³»ç»Ÿæ„å»ºä»»åŠ¡ç³»ç»Ÿ
- æ”¯æŒä¸»çº¿ä»»åŠ¡å’Œæ”¯çº¿ä»»åŠ¡
- ä»»åŠ¡å¥–åŠ±å’Œæƒ©ç½šæœºåˆ¶

### 3. æˆ˜æ–—ç³»ç»Ÿ
- é›†æˆç°æœ‰çš„æˆ˜æ–—æŠ€èƒ½ç³»ç»Ÿ
- åŸºäºæ—¶é—´å’Œå¤©æ°”çš„æˆ˜æ–—å½±å“
- æˆ˜æ–—ç»“æœå¯¹èµ„æºçš„å½±å“

### 4. å»ºé€ ç³»ç»Ÿ
- åŸºäºææ–™èµ„æºçš„å»ºé€ ç³»ç»Ÿ
- å»ºç­‘å¯¹èµ„æºç”Ÿäº§å’Œæ¶ˆè€—çš„å½±å“
- é˜²å¾¡è®¾æ–½çš„å»ºé€ å’Œç»´æŠ¤

## æ³¨æ„äº‹é¡¹

1. **å•ä¾‹æ¨¡å¼**: GameManagerä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼Œç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹
2. **ä¿¡å·è¿æ¥**: æ‰€æœ‰ç®¡ç†å™¨éƒ½é€šè¿‡ä¿¡å·ç³»ç»Ÿé€šä¿¡ï¼Œé¿å…ç›´æ¥å¼•ç”¨
3. **èµ„æºç®¡ç†**: ç³»ç»Ÿä¼šè‡ªåŠ¨ç®¡ç†èµ„æºçš„ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼
4. **é”™è¯¯å¤„ç†**: æ‰€æœ‰å…³é”®æ“ä½œéƒ½åŒ…å«å¼‚å¸¸å¤„ç†ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§

## æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†é¢‘ç¹åˆ›å»ºçš„å¯¹è±¡
- å»¶è¿Ÿæ›´æ–°éå…³é”®ç³»ç»Ÿ
- æ‰¹é‡å¤„ç†èµ„æºå˜åŒ–
- æ™ºèƒ½çš„äº‹ä»¶è§¦å‘æœºåˆ¶

è¿™ä¸ªç³»ç»Ÿä¸ºä½ çš„æ¸¸æˆæä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„åŸºç¡€æ¡†æ¶ï¼Œå¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œæ‰©å±•å’Œå®šåˆ¶ã€‚
